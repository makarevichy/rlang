<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bind symbols to objects in an environment — env_bind • rlang</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bind symbols to objects in an environment — env_bind" />

<meta property="og:description" content="These functions create bindings in an environment. The bindings are
supplied through ... as pairs of names and values or expressions.
env_bind() is equivalent to evaluating a &amp;lt;- expression within
the given environment. This function should take care of the
majority of use cases but the other variants can be useful for
specific problems.
env_bind() takes named values which are bound in .env.
env_bind() is equivalent to base::assign().
env_bind_active() takes named functions and creates active
bindings in .env. This is equivalent to
base::makeActiveBinding(). An active binding executes a
function each time it is evaluated. The arguments are passed to
as_function() so you can supply formulas instead of functions.
Remember that functions are scoped in their own environment.
These functions can thus refer to symbols from this enclosure
that are not actually in scope in the dynamic environment where
the active bindings are invoked. This allows creative solutions
to difficult problems (see the implementations of dplyr::do()
methods for an example).
env_bind_lazy() takes named expressions. This is equivalent
to base::delayedAssign(). The arguments are captured with
exprs() (and thus support call-splicing and unquoting) and
assigned to symbols in .env. These expressions are not
evaluated immediately but lazily. Once a symbol is evaluated, the
corresponding expression is evaluated in turn and its value is
bound to the symbol (the expressions are thus evaluated only
once, if at all).
" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rlang</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../reference/lifecycle.html">Life cycle</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/rlang">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bind symbols to objects in an environment</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/rlang/blob/master/R/env-binding.R'><code>R/env-binding.R</code></a></small>
    <div class="hidden name"><code>env_bind.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions create bindings in an environment. The bindings are
supplied through <code>...</code> as pairs of names and values or expressions.
<code>env_bind()</code> is equivalent to evaluating a <code>&lt;-</code> expression within
the given environment. This function should take care of the
majority of use cases but the other variants can be useful for
specific problems.</p><ul>
<li><p><code>env_bind()</code> takes named <em>values</em> which are bound in <code>.env</code>.
<code>env_bind()</code> is equivalent to <code><a href='http://www.rdocumentation.org/packages/base/topics/assign'>base::assign()</a></code>.</p></li>
<li><p><code>env_bind_active()</code> takes named <em>functions</em> and creates active
bindings in <code>.env</code>. This is equivalent to
<code><a href='http://www.rdocumentation.org/packages/base/topics/bindenv'>base::makeActiveBinding()</a></code>. An active binding executes a
function each time it is evaluated. The arguments are passed to
<code><a href='as_function.html'>as_function()</a></code> so you can supply formulas instead of functions.</p>
<p>Remember that functions are scoped in their own environment.
These functions can thus refer to symbols from this enclosure
that are not actually in scope in the dynamic environment where
the active bindings are invoked. This allows creative solutions
to difficult problems (see the implementations of <code>dplyr::do()</code>
methods for an example).</p></li>
<li><p><code>env_bind_lazy()</code> takes named <em>expressions</em>. This is equivalent
to <code><a href='http://www.rdocumentation.org/packages/base/topics/delayedAssign'>base::delayedAssign()</a></code>. The arguments are captured with
<code><a href='quotation.html'>exprs()</a></code> (and thus support call-splicing and unquoting) and
assigned to symbols in <code>.env</code>. These expressions are not
evaluated immediately but lazily. Once a symbol is evaluated, the
corresponding expression is evaluated in turn and its value is
bound to the symbol (the expressions are thus evaluated only
once, if at all).</p></li>
</ul>
    
    </div>

    <pre class="usage"><span class='fu'>env_bind</span>(<span class='no'>.env</span>, <span class='no'>...</span>)

<span class='fu'>env_bind_lazy</span>(<span class='no'>.env</span>, <span class='no'>...</span>, <span class='kw'>.eval_env</span> <span class='kw'>=</span> <span class='fu'><a href='caller_env.html'>caller_env</a></span>())

<span class='fu'>env_bind_active</span>(<span class='no'>.env</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.env</th>
      <td><p>An environment.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Pairs of names and expressions, values or functions.
These dots support <a href='tidy-dots.html'>tidy dots</a> features.</p></td>
    </tr>
    <tr>
      <th>.eval_env</th>
      <td><p>The environment where the expressions will be
evaluated when the symbols are forced.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The input object <code>.env</code>, with its associated environment
modified in place, invisibly.</p>
    
    <h2 class="hasAnchor" id="side-effects"><a class="anchor" href="#side-effects"></a>Side effects</h2>

    
    <p>Since environments have reference semantics (see relevant section
in <code><a href='env.html'>env()</a></code> documentation), modifying the bindings of an environment
produces effects in all other references to that environment. In
other words, <code>env_bind()</code> and its variants have side effects.</p>
<p>Like other side-effecty functions like <code>par()</code> and <code>options()</code>,
<code>env_bind()</code> and variants return the old values invisibly.</p>
    
    <h2 class="hasAnchor" id="life-cycle"><a class="anchor" href="#life-cycle"></a>Life cycle</h2>

    
    <p>Passing an environment wrapper like a formula or a function instead
of an environment is soft-deprecated as of rlang 0.3.0. This
internal genericity was causing confusion (see issue #427). You
should now extract the environment separately before calling these
functions.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># env_bind() is a programmatic way of assigning values to symbols</span>
<span class='co'># with `&lt;-`. We can add bindings in the current environment:</span>
<span class='fu'>env_bind</span>(<span class='fu'><a href='caller_env.html'>current_env</a></span>(), <span class='kw'>foo</span> <span class='kw'>=</span> <span class='st'>"bar"</span>)
<span class='no'>foo</span></div><div class='output co'>#&gt; [1] "bar"</div><div class='input'>
<span class='co'># Or modify those bindings:</span>
<span class='no'>bar</span> <span class='kw'>&lt;-</span> <span class='st'>"bar"</span>
<span class='fu'>env_bind</span>(<span class='fu'><a href='caller_env.html'>current_env</a></span>(), <span class='kw'>bar</span> <span class='kw'>=</span> <span class='st'>"BAR"</span>)
<span class='no'>bar</span></div><div class='output co'>#&gt; [1] "BAR"</div><div class='input'>
<span class='co'># You can remove bindings by supplying zap sentinels:</span>
<span class='fu'>env_bind</span>(<span class='fu'><a href='caller_env.html'>current_env</a></span>(), <span class='kw'>foo</span> <span class='kw'>=</span> <span class='fu'><a href='zap.html'>zap</a></span>())
<span class='fu'>try</span>(<span class='no'>foo</span>)

<span class='co'># Unquote-splice a named list of zaps</span>
<span class='no'>zaps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rep_along.html'>rep_named</a></span>(<span class='fu'>c</span>(<span class='st'>"foo"</span>, <span class='st'>"bar"</span>), <span class='fu'>list</span>(<span class='fu'><a href='zap.html'>zap</a></span>()))
<span class='fu'>env_bind</span>(<span class='fu'><a href='caller_env.html'>current_env</a></span>(), !!!<span class='no'>zaps</span>)
<span class='fu'>try</span>(<span class='no'>bar</span>)

<span class='co'># It is most useful to change other environments:</span>
<span class='no'>my_env</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='env.html'>env</a></span>()
<span class='fu'>env_bind</span>(<span class='no'>my_env</span>, <span class='kw'>foo</span> <span class='kw'>=</span> <span class='st'>"foo"</span>)
<span class='no'>my_env</span>$<span class='no'>foo</span></div><div class='output co'>#&gt; [1] "foo"</div><div class='input'>
<span class='co'># A useful feature is to splice lists of named values:</span>
<span class='no'>vals</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>20</span>)
<span class='fu'>env_bind</span>(<span class='no'>my_env</span>, !!!<span class='no'>vals</span>, <span class='kw'>c</span> <span class='kw'>=</span> <span class='fl'>30</span>)
<span class='no'>my_env</span>$<span class='no'>b</span></div><div class='output co'>#&gt; [1] 20</div><div class='input'><span class='no'>my_env</span>$<span class='no'>c</span></div><div class='output co'>#&gt; [1] 30</div><div class='input'>
<span class='co'># You can also unquote a variable referring to a symbol or a string</span>
<span class='co'># as binding name:</span>
<span class='no'>var</span> <span class='kw'>&lt;-</span> <span class='st'>"baz"</span>
<span class='fu'>env_bind</span>(<span class='no'>my_env</span>, !!<span class='no'>var</span> <span class='kw'>:=</span> <span class='st'>"BAZ"</span>)
<span class='no'>my_env</span>$<span class='no'>baz</span></div><div class='output co'>#&gt; [1] "BAZ"</div><div class='input'>

<span class='co'># The old values of the bindings are returned invisibly:</span>
<span class='no'>old</span> <span class='kw'>&lt;-</span> <span class='fu'>env_bind</span>(<span class='no'>my_env</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>baz</span> <span class='kw'>=</span> <span class='st'>"baz"</span>)
<span class='no'>old</span></div><div class='output co'>#&gt; $a
#&gt; [1] 10
#&gt; 
#&gt; $b
#&gt; [1] 20
#&gt; 
#&gt; $baz
#&gt; [1] "BAZ"
#&gt; </div><div class='input'>
<span class='co'># You can restore the original environment state by supplying the</span>
<span class='co'># old values back:</span>
<span class='fu'>env_bind</span>(<span class='no'>my_env</span>, !!!<span class='no'>old</span>)

<span class='co'># env_bind_lazy() assigns expressions lazily:</span>
<span class='no'>env</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='env.html'>env</a></span>()
<span class='fu'>env_bind_lazy</span>(<span class='no'>env</span>, <span class='kw'>name</span> <span class='kw'>=</span> { <span class='fu'>cat</span>(<span class='st'>"forced!\n"</span>); <span class='st'>"value"</span> })

<span class='co'># Referring to the binding will cause evaluation:</span>
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; forced!</div><div class='output co'>#&gt; [1] "value"</div><div class='input'>
<span class='co'># But only once, subsequent references yield the final value:</span>
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; [1] "value"</div><div class='input'>
<span class='co'># You can unquote expressions:</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='fu'>message</span>(<span class='st'>"forced!"</span>))
<span class='fu'>env_bind_lazy</span>(<span class='no'>env</span>, <span class='kw'>name</span> <span class='kw'>=</span> !!<span class='no'>expr</span>)
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; <span class='message'>forced!</span></div><div class='output co'>#&gt; NULL</div><div class='input'>

<span class='co'># By default the expressions are evaluated in the current</span>
<span class='co'># environment. For instance we can create a local binding and refer</span>
<span class='co'># to it, even though the variable is bound in a different</span>
<span class='co'># environment:</span>
<span class='no'>who</span> <span class='kw'>&lt;-</span> <span class='st'>"mickey"</span>
<span class='fu'>env_bind_lazy</span>(<span class='no'>env</span>, <span class='kw'>name</span> <span class='kw'>=</span> <span class='fu'>paste</span>(<span class='no'>who</span>, <span class='st'>"mouse"</span>))
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; [1] "mickey mouse"</div><div class='input'>
<span class='co'># You can specify another evaluation environment with `.eval_env`:</span>
<span class='no'>eval_env</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='env.html'>env</a></span>(<span class='kw'>who</span> <span class='kw'>=</span> <span class='st'>"minnie"</span>)
<span class='fu'>env_bind_lazy</span>(<span class='no'>env</span>, <span class='kw'>name</span> <span class='kw'>=</span> <span class='fu'>paste</span>(<span class='no'>who</span>, <span class='st'>"mouse"</span>), <span class='kw'>.eval_env</span> <span class='kw'>=</span> <span class='no'>eval_env</span>)
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; [1] "minnie mouse"</div><div class='input'>
<span class='co'># Or by unquoting a quosure:</span>
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'>local</span>({
  <span class='no'>who</span> <span class='kw'>&lt;-</span> <span class='st'>"fievel"</span>
  <span class='fu'><a href='quotation.html'>quo</a></span>(<span class='fu'>paste</span>(<span class='no'>who</span>, <span class='st'>"mouse"</span>))
})
<span class='fu'>env_bind_lazy</span>(<span class='no'>env</span>, <span class='kw'>name</span> <span class='kw'>=</span> !!<span class='no'>quo</span>)
<span class='no'>env</span>$<span class='no'>name</span></div><div class='output co'>#&gt; [1] "fievel mouse"</div><div class='input'>
<span class='co'># You can create active bindings with env_bind_active(). Active</span>
<span class='co'># bindings execute a function each time they are evaluated:</span>
<span class='no'>fn</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() {
  <span class='fu'>cat</span>(<span class='st'>"I have been called\n"</span>)
  <span class='fu'>rnorm</span>(<span class='fl'>1</span>)
}

<span class='no'>env</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='env.html'>env</a></span>()
<span class='fu'>env_bind_active</span>(<span class='no'>env</span>, <span class='kw'>symbol</span> <span class='kw'>=</span> <span class='no'>fn</span>)

<span class='co'># `fn` is executed each time `symbol` is evaluated or retrieved:</span>
<span class='no'>env</span>$<span class='no'>symbol</span></div><div class='output co'>#&gt; I have been called</div><div class='output co'>#&gt; [1] -1.400044</div><div class='input'><span class='no'>env</span>$<span class='no'>symbol</span></div><div class='output co'>#&gt; I have been called</div><div class='output co'>#&gt; [1] 0.2553171</div><div class='input'><span class='fu'><a href='eval_bare.html'>eval_bare</a></span>(<span class='fu'>quote</span>(<span class='no'>symbol</span>), <span class='no'>env</span>)</div><div class='output co'>#&gt; I have been called</div><div class='output co'>#&gt; [1] -2.437264</div><div class='input'><span class='fu'><a href='eval_bare.html'>eval_bare</a></span>(<span class='fu'>quote</span>(<span class='no'>symbol</span>), <span class='no'>env</span>)</div><div class='output co'>#&gt; I have been called</div><div class='output co'>#&gt; [1] -0.005571287</div><div class='input'>
<span class='co'># All arguments are passed to as_function() so you can use the</span>
<span class='co'># formula shortcut:</span>
<span class='fu'>env_bind_active</span>(<span class='no'>env</span>, <span class='kw'>foo</span> <span class='kw'>=</span> ~ <span class='fu'>runif</span>(<span class='fl'>1</span>))
<span class='no'>env</span>$<span class='no'>foo</span></div><div class='output co'>#&gt; [1] 0.732882</div><div class='input'><span class='no'>env</span>$<span class='no'>foo</span></div><div class='output co'>#&gt; [1] 0.7725215</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#side-effects">Side effects</a></li>

      <li><a href="#life-cycle">Life cycle</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lionel Henry, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

